# This file is automatically generated by the Nebula SDK. DO NOT EDIT.

FROM alpine:3
RUN set -eux ; \
    mkdir -p /tmp/ni && \
    cd /tmp/ni && \
    wget https://packages.nebula.puppet.net/sdk/ni/v1/ni-v1-linux-amd64.tar.xz && \
    wget https://packages.nebula.puppet.net/sdk/ni/v1/ni-v1-linux-amd64.tar.xz.sha256 && \
    echo "$( cat ni-v1-linux-amd64.tar.xz.sha256 )  ni-v1-linux-amd64.tar.xz" | sha256sum -c - && \
    tar -xvJf ni-v1-linux-amd64.tar.xz && \
    mv ni-v1*-linux-amd64 /usr/local/bin/ni && \
    cd - && \
    rm -fr /tmp/ni
RUN apk --no-cache add bash ca-certificates curl git jq openssh && update-ca-certificates
RUN set -eux ; \
    mkdir -p /tmp/kubectl && \
    cd /tmp/kubectl && \
    curl -LO https://storage.googleapis.com/kubernetes-release/release/v1.18.16/bin/linux/amd64/kubectl && \
    echo "$( curl -sL https://storage.googleapis.com/kubernetes-release/release/v1.18.16/bin/linux/amd64/kubectl.sha256 )  kubectl" | sha256sum -c - && \
    chmod +x kubectl && \
    mv kubectl /usr/local/bin/kubectl && \
    cd - && \
    rm -fr /tmp/kubectl
RUN set -eux ; \
    mkdir -p /tmp/kustomize && \
    wget https://github.com/kubernetes-sigs/kustomize/releases/download/kustomize%2Fv3.8.10/kustomize_v3.8.10_linux_amd64.tar.gz && \
    tar -xvzf kustomize_v3.8.10_linux_amd64.tar.gz && \
    mv kustomize /usr/local/bin/kustomize && \
    cd - && \
    rm -fr /tmp/kustomize
RUN kustomize version
COPY "./step.sh" "/nebula/step-kustomize.sh"
ENTRYPOINT []
CMD ["/bin/bash", "/nebula/step-kustomize.sh"]

LABEL "org.opencontainers.image.title"="Kustomize"
LABEL "org.opencontainers.image.description"="The Kustomize task applies Kubernetes kustomizations."
LABEL "com.puppet.nebula.sdk.version"="v1"
